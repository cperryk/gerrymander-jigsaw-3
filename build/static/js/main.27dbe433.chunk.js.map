{"version":3,"sources":["utils.ts","EndSlide.tsx","PuzzlePiece.tsx","PuzzleGuide.tsx","Puzzle.tsx","StartSlide.tsx","Timer.tsx","App.tsx","serviceWorker.ts","index.tsx"],"names":["parseMilliseconds","milliseconds","minutes","Math","floor","round","constrainToAspectRatio","aspectRatio","width","height","ratio","EndSlide","title","subtitle","shareText","onRestart","shareUrl","params","parse","window","location","search","parentUrl","decodeURIComponent","href","getShareUrl","className","FacebookShareButton","url","quote","color","TwitterShareButton","EmailShareButton","subject","onClick","PuzzlePiece","props","hoverColor","dragColor","state","dragging","hovering","handleMouseEnter","bind","handleMouseOut","pathEls","this","paths","map","path","index","d","fill","key","cursor","locked","scale","dragScale","onStart","handleDragStart","onStop","handleDragStop","disabled","position","x","y","classnames","onMouseEnter","onMouseOut","setState","onDragStart","e","draggableData","onDragStop","React","PureComponent","PuzzleGuide","ref","createRef","current","getBoundingClientRect","Component","Puzzle","colorScale","chroma","domain","pieces","length","piece","originalPosition","transform","guideRef","pieceRef","tolerance","getDragScale","stage","guides","bboxGuide","devMode","viewBox","join","prevProps","slice","forEach","isPieceSolved","every","movePieceToFront","isAllSolved","onSolved","logPositions","positions","reduce","prev","curr","toFixed","console","log","JSON","stringify","StartSlide","Timer","time","seconds","minutesStr","secondsStr","formatTime","ASPECT_RATIO","App","interval","configuration","minX","minY","Object","entries","transforms","parseFloat","startTime","Date","duration","dimensions","innerWidth","innerHeight","handleSolved","handleStart","handleRestart","handleTouchStart","timeVerbose","parts","push","formatTimeVerbose","replace","document","addEventListener","setInterval","incrementTime","pymChild","pym","Child","getParentPositionInfo","onMessage","message","split","min","Number","sendHeight","removeEventListener","clearInterval","date","getTime","preventDefault","stopPropagation","Boolean","hostname","match","ReactDOM","render","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"mQAIA,SAASA,EAAkBC,GACzB,IAAMC,EAAUC,KAAKC,MAAMH,EAAY,KAEvC,MAAO,CAACC,EADQC,KAAKE,OAAOJ,EAAyB,GAAVC,EAAe,KAAQ,MA2D7D,SAASI,EAAT,EAELC,GACa,IAFXC,EAEU,EAFVA,MAAOC,EAEG,EAFHA,OAGHC,EAAQF,EAAQC,EAEtB,OAAIC,EAAQH,EAEH,CACLE,SACAD,MAAOC,EAASF,GAETG,EAAQH,EACV,CACLE,OAAQD,EAAQD,EAChBC,SAGK,CAAEA,QAAOC,U,uCCzEPE,EAKR,SAAC,GAA+C,IAA7CC,EAA4C,EAA5CA,MAAOC,EAAqC,EAArCA,SAAUC,EAA2B,EAA3BA,UAAWC,EAAgB,EAAhBA,UAC5BC,EDiBD,WACL,IAAMC,EAASC,gBAAMC,OAAOC,SAASC,QACrC,MAAmC,kBAArBJ,EAAOK,UACjBC,mBAAmBN,EAAOK,WAC1BH,OAAOC,SAASI,KCrBHC,GACjB,OACE,yBAAKC,UAAU,SACb,6BACE,4BAAKd,GACL,uBAAGc,UAAU,YAAYb,GACzB,yBAAKa,UAAU,cACb,kBAACC,EAAA,EAAD,CACED,UAAU,aACVE,IAAKZ,EACLa,MAAOf,GAEP,kBAAC,IAAD,CAAagB,MAAM,qBACnB,wCAEF,kBAACC,EAAA,EAAD,CACEL,UAAU,aACVE,IAAKZ,EACLJ,MAAOE,GAEP,kBAAC,IAAD,CAAWgB,MAAM,sBALnB,SAQA,kBAACE,EAAA,EAAD,CACEN,UAAU,aACVE,IAAKZ,EACLiB,QAASnB,GAET,kBAAC,IAAD,CAAegB,MAAM,oBALvB,UASF,yBAAKJ,UAAU,aAAaQ,QAASnB,GACnC,kBAAC,IAAD,MACA,6C,2DC9CGoB,EAAb,YAmBE,WAAYC,GAAQ,IAAD,8BACjB,4CAAMA,KAHRC,gBAEmB,IADnBC,eACmB,EAEjB,EAAKC,MAAQ,CACXT,MAAO,EAAKM,MAAMN,MAClBU,UAAU,EACVC,UAAU,GAEZ,EAAKJ,WAAa,yBAClB,EAAKC,UAAY,SACjB,EAAKI,iBAAmB,EAAKA,iBAAiBC,KAAtB,gBACxB,EAAKC,eAAiB,EAAKA,eAAeD,KAApB,gBAVL,EAnBrB,sEA+BY,IAAD,OACDE,EAAUC,KAAKV,MAAMW,MAAMC,KAAI,SAACC,EAAMC,GAC1C,OACE,0BACEC,EAAGF,EACHvB,UAAU,oBACV0B,KAAM,EAAKb,MAAMT,MACjBuB,IAAKH,EACLI,OAAQ,EAAKlB,MAAMmB,OAAS,SAAW,YAI7C,OACE,kBAAC,IAAD,CACEC,MAAOV,KAAKV,MAAMqB,UAClBC,QAASZ,KAAKa,gBAAgBhB,KAAKG,MACnCc,OAAQd,KAAKe,eAAelB,KAAKG,MACjCgB,SAAUhB,KAAKV,MAAMmB,OACrBQ,SAAU,CAAEC,EAAGlB,KAAKV,MAAM2B,SAAS,GAAIE,EAAGnB,KAAKV,MAAM2B,SAAS,KAE9D,uBACErC,UAAWwC,IAAW,CACpB,sBAAsB,EACtB1B,SAAUM,KAAKP,MAAMC,SACrBC,SAAUK,KAAKP,MAAME,WAEvB0B,aAAcrB,KAAKJ,iBACnB0B,WAAYtB,KAAKF,gBAEhBC,MA5DX,yCAkEIC,KAAKuB,SAAS,CACZ5B,UAAU,MAnEhB,uCAuEIK,KAAKuB,SAAS,CACZ5B,UAAU,MAxEhB,wCA4EIK,KAAKuB,SAAS,CACZ7B,UAAU,IAEZM,KAAKV,MAAMkC,YAAYxB,KAAKV,MAAMc,SA/EtC,qCAiFiBqB,EAAeC,GAC5B1B,KAAKuB,SAAS,CACZ7B,UAAU,IAEZM,KAAKV,MAAMqC,WAAW3B,KAAKV,MAAMc,MAAOsB,OArF5C,GAAiCE,IAAMC,eCH1BC,EAAb,YAIE,WAAYxC,GAAQ,IAAD,8BACjB,4CAAMA,KAFDyC,SACY,EAEjB,EAAKA,IAAMH,IAAMI,YAFA,EAJrB,sEASI,IAAMjC,EAAUC,KAAKV,MAAMW,MAAMC,KAAI,SAACC,EAAMC,GAC1C,OAAO,0BAAMxB,UAAU,oBAAoByB,EAAGF,EAAMI,IAAKH,OAE3D,OAAO,uBAAG2B,IAAK/B,KAAK+B,KAAMhC,KAZ9B,gCAeI,IAAMgC,EAAM/B,KAAK+B,IACjB,GAAmB,kBAARA,GAAoBA,GAAOA,EAAIE,QACxC,OAAOF,EAAIE,QAAQC,4BAjBzB,GAAiCN,IAAMO,WCM1BC,EAAb,YAwBE,WAAY9C,GAAQ,IAAD,uBACjB,4CAAMA,KAFAyC,SACW,EAEjB,IAAMM,EAAaC,IAChB5B,MAAM,YACN6B,OAAO,CAAC,EAAGjD,EAAMkD,OAAOC,QAASnD,EAAMkD,OAAOC,QAJhC,OAMjB,EAAKhD,MAAQ,CACX+C,OAAQlD,EAAMkD,OAAOtC,KAAI,SAACwC,EAAOtC,GAAR,MAAmB,CAC1CG,IAAKmC,EAAMnC,IACXN,MAAOyC,EAAMzC,MACb0C,iBAAkBD,EAAME,UACxB3B,SAAUyB,EAAME,UAChB5D,MAAOqD,EAAWjC,GAClByC,SAAUjB,IAAMI,YAChBc,SAAUlB,IAAMI,gBAElBe,UAAW,IAEb,EAAKhB,IAAMH,IAAMI,YACjB,EAAKnB,gBAAkB,EAAKA,gBAAgBhB,KAArB,gBACvB,EAAKkB,eAAiB,EAAKA,eAAelB,KAApB,gBApBL,EAxBrB,sEA8CY,IAAD,OACDc,EAAYX,KAAKgD,aAAahD,KAAKV,MAAM5B,MAAOsC,KAAKV,MAAM3B,QAC3D6E,EAASxC,KAAKP,MAAM+C,OAAOtC,KAAI,SAACwC,EAAOtC,GAAR,OACnC,kBAAC,EAAD,CACEA,MAAOA,EACPH,MAAOyC,EAAMzC,MACbM,IAAKmC,EAAMnC,IACXvB,MAAO0D,EAAM1D,MACbwC,YAAa,EAAKX,gBAClBc,WAAY,EAAKZ,eACjBJ,UAAWA,EACXoB,IAAKW,EAAMI,SACXrC,OAA6B,QAArB,EAAKnB,MAAM2D,MACnBhC,SAAUyB,EAAMzB,cAGdiC,EAASlD,KAAKP,MAAM+C,OAAOtC,KAAI,SAACwC,EAAOtC,GAAR,OACnC,kBAAC,EAAD,CAAaH,MAAOyC,EAAMzC,MAAO8B,IAAKW,EAAMG,SAAUtC,IAAKH,OAEvD+C,EAAYnD,KAAKV,MAAM8D,QAC3B,0BACElC,EAAGlB,KAAKV,MAAM+D,QAAQ,GACtBlC,EAAGnB,KAAKV,MAAM+D,QAAQ,GACtB3F,MAAOsC,KAAKV,MAAM+D,QAAQ,GAC1B1F,OAAQqC,KAAKV,MAAM+D,QAAQ,KAE3B,KACJ,OACE,yBAAKzE,UAAU,UACb,yBACElB,MAAOsC,KAAKV,MAAM5B,MAClBC,OAAQqC,KAAKV,MAAM3B,OACnB0F,QAASrD,KAAKV,MAAM+D,QAAQC,KAAK,KACjCvB,IAAK/B,KAAK+B,KAEToB,EACAD,EACAV,MAnFX,yCAwFqBe,GACjB,GAAIA,EAAUN,QAAUjD,KAAKV,MAAM2D,MACjC,OAAQjD,KAAKV,MAAM2D,OACjB,IAAK,UACL,IAAK,UACHjD,KAAKuB,SAAS,CACZiB,OAAQxC,KAAKP,MAAM+C,OAAOtC,KAAI,SAAAwC,GAE5B,OADAA,EAAMzB,SAAWyB,EAAMC,iBAChBD,OAGX,MACF,IAAK,MACH1C,KAAKuB,SAAS,CACZiB,OAAQxC,KAAKP,MAAM+C,OAAOtC,KAAI,SAAAwC,GAE5B,OADAA,EAAMzB,SAAW,CAAC,EAAG,GACdyB,UAxGrB,mCA+GehF,EAAeC,GAC1B,GAAwB,kBAAbqC,KAAK+B,IAAhB,CADkD,IAE1CsB,EAAYrD,KAAKV,MAAjB+D,QAOR,OAN4B3F,EAAQC,EACT0F,EAAQ,GAAKA,EAAQ,GAG5C1F,EAASqC,KAAKV,MAAM+D,QAAQ,GAC5B3F,EAAQsC,KAAKV,MAAM+D,QAAQ,MAvHnC,uCA0HmBjD,GACXA,IAAUJ,KAAKP,MAAM+C,OAAOC,OAAS,GACzCzC,KAAKuB,SAAS,CACZiB,OAAO,GAAD,mBACDxC,KAAKP,MAAM+C,OAAOgB,MAAM,EAAGpD,IAD1B,YAEDJ,KAAKP,MAAM+C,OAAOgB,MAAMpD,EAAQ,EAAGJ,KAAKP,MAAM+C,OAAOC,SAFpD,CAGJzC,KAAKP,MAAM+C,OAAOpC,SAhI1B,oCAoIgBA,GAAyB,IAAD,cAGhCJ,KAAKP,MAAM+C,OAAOpC,GADpBa,SAFkC,GAEvBC,EAFuB,KAEpBC,EAFoB,KAI5B4B,EAAc/C,KAAKP,MAAnBsD,UACR,OAAO7B,GAAK6B,GAAa7B,EAAI6B,GAAa5B,GAAK4B,GAAa5B,EAAI4B,IAzIpE,oCA2IiB,IAAD,OAEZ,OADA/C,KAAKP,MAAM+C,OAAOiB,SAAQ,SAACf,EAAOtC,GAAR,OAAkB,EAAKsD,cAActD,MACxDJ,KAAKP,MAAM+C,OAAOmB,OAAM,SAACjB,EAAOtC,GAAR,OAAkB,EAAKsD,cAActD,QA7IxE,sCA+IkBA,GACdJ,KAAK4D,iBAAiBxD,KAhJ1B,qCAkJiBA,EAAeqB,GACdzB,KAAKP,MAAM+C,OAAOpC,GAC1Ba,SAAW,CAACQ,EAAEP,EAAGO,EAAEN,GAEzBnB,KAAKuB,SAAS,CACZiB,OAAO,YAAKxC,KAAKP,MAAM+C,UAGrBxC,KAAK6D,eACP7D,KAAKV,MAAMwE,WAEb9D,KAAK+D,iBA7JT,qCAiKI,GAAK/D,KAAKV,MAAM8D,QAAhB,CACA,IAAMY,EAAYhE,KAAKP,MAAM+C,OAAOyB,QAAO,SAACC,EAAMC,GAChD,IAAMlD,EAAWkD,EAAKlD,SACtB,GAAIA,EAAU,CAAC,IAAD,cACGA,EADH,GACLC,EADK,KACFC,EADE,KAEZ+C,EAAKC,EAAK5D,KAAO,CAACW,EAAEkD,QAAQ,GAAIjD,EAAEiD,QAAQ,IAE5C,OAAOF,IACN,IACHG,QAAQC,IAAIC,KAAKC,UAAUR,SA1K/B,GAA4BpC,IAAMC,eCLrB4C,EAGR,SAAAnF,GACH,OACE,yBAAKV,UAAU,SACb,6BACE,4BAAKU,EAAMxB,OACX,yBAAKc,UAAU,uBAAuBQ,QAASE,EAAMsB,SAArD,aCPK8D,EAAmD,SAAC,GAAc,IAAZC,EAAW,EAAXA,KACjE,OAAO,yBAAK/F,UAAU,SNsBjB,SAAoBzB,GAA+B,IAAD,EAC5BD,EAAkBC,GADU,mBAChDC,EADgD,KACvCwH,EADuC,KAEjDC,EAAazH,GAAW,GAAX,UAAmBA,GAAnB,WAAmCA,GAChD0H,EAAaF,GAAW,GAAX,UAAmBA,GAAnB,WAAmCA,GACtD,MAAM,GAAN,OAAUC,EAAV,YAAwBC,GM1BOC,CAAWJ,K,iBCWtCK,EAAe,GAgJNC,E,YAhIb,WAAY3F,GAAQ,IAAD,uBACjB,4CAAMA,KAFD4F,cACY,QPUZ,CACL7B,QAAS,CACP8B,EAAc9B,QAAQ+B,KACtBD,EAAc9B,QAAQgC,KACtBF,EAAc9B,QAAQ3F,MACtByH,EAAc9B,QAAQ1F,QAExB6E,OAAQ8C,OAAOC,QAAQJ,EAAclF,OAAOC,KAAI,YAAmB,IAAD,mBAAhBK,EAAgB,KAAXN,EAAW,OACjDkF,EAAcK,WAAWjF,IAAQ,CAAC,IAAK,KADU,mBACzDW,EADyD,KACtDC,EADsD,KAEhE,MAAO,CACLZ,MACAN,QACA2C,UAAW,CAAC6C,WAAWvE,GAAIuE,WAAWtE,QAG1CrD,MAAOqH,EAAcrH,MACrBE,UAAWmH,EAAcnH,WOxBjBwE,EAFS,EAETA,OAAQa,EAFC,EAEDA,QAASvF,EAFR,EAEQA,MAAOE,EAFf,EAEeA,UAFf,OAGjB,EAAKyB,MAAQ,CACX+C,SACAa,UACAvF,QACAE,YACA0H,UAAW,IAAIC,KACfC,SAAU,EACV3C,MAAO,QACP4C,WAAYrI,EACV,CACEE,MAAOW,OAAOyH,WACdnI,OAAQU,OAAO0H,aAEjBf,IAGJ,EAAKgB,aAAe,EAAKA,aAAanG,KAAlB,gBACpB,EAAKoG,YAAc,EAAKA,YAAYpG,KAAjB,gBACnB,EAAKqG,cAAgB,EAAKA,cAAcrG,KAAnB,gBACrB,EAAKsG,iBAAmB,EAAKA,iBAAiBtG,KAAtB,gBAtBP,E,sEAyBjB,OAAQG,KAAKP,MAAMwD,OACjB,IAAK,QACH,OACE,yBAAKrE,UAAU,OACb,kBAAC,EAAD,CAAYd,MAAOkC,KAAKP,MAAM3B,MAAO8C,QAASZ,KAAKiG,cACnD,kBAAC,EAAD,CACEhD,MAAM,UACNT,OAAQxC,KAAKP,MAAM+C,OACnBa,QAASrD,KAAKP,MAAM4D,QACpB3F,MAAOsC,KAAKP,MAAMoG,WAAWnI,MAC7BC,OAAQqC,KAAKP,MAAMoG,WAAWlI,UAItC,IAAK,SACH,OACE,yBAAKiB,UAAU,OACb,kBAAC,EAAD,CAAO+F,KAAM3E,KAAKP,MAAMmG,WACxB,kBAAC,EAAD,CACE3C,MAAM,UACNa,SAAU9D,KAAKgG,aACfxD,OAAQxC,KAAKP,MAAM+C,OACnBa,QAASrD,KAAKP,MAAM4D,QACpB3F,MAAOsC,KAAKP,MAAMoG,WAAWnI,MAC7BC,OAAQqC,KAAKP,MAAMoG,WAAWlI,UAItC,IAAK,MACH,IAAMyI,EP3EP,SAA2BjJ,GAA+B,IAAD,EACnCD,EAAkBC,GADiB,mBACvDC,EADuD,KAC9CwH,EAD8C,KAExDyB,EAAQ,GAWd,OAVgB,IAAZjJ,EACFiJ,EAAMC,KAAK,YACFlJ,EAAU,GACnBiJ,EAAMC,KAAN,UAAclJ,GAAW,EAAzB,aAEc,IAAZwH,EACFyB,EAAMC,KAAK,YACF1B,EAAU,GACnByB,EAAMC,KAAN,UAAc1B,GAAW,EAAzB,aAEKyB,EAAM/C,KAAK,MO8DQiD,CAAkBvG,KAAKP,MAAMmG,UAC3C5H,EAAYgC,KAAKP,MAAMzB,UAAUwI,QAAQ,SAAUJ,GACzD,OACE,yBAAKxH,UAAU,OACb,kBAAC,EAAD,CACEd,MAAM,UACNC,SAAQ,mCAA8BqI,EAA9B,KACRpI,UAAWA,EACXC,UAAW+B,KAAKkG,gBAElB,kBAAC,EAAD,CACEjD,MAAM,MACNT,OAAQxC,KAAKP,MAAM+C,OACnBa,QAASrD,KAAKP,MAAM4D,QACpB3F,MAAOsC,KAAKP,MAAMoG,WAAWnI,MAC7BC,OAAQqC,KAAKP,MAAMoG,WAAWlI,a,0CAMrB,IAAD,OAClB8I,SAASC,iBAAiB,aAAc1G,KAAKmG,kBAC7CnG,KAAKkF,SAAWyB,aAAY,kBAAM,EAAKC,kBAAiB,KACxD,IAAMC,EAAW,IAAIC,IAAIC,MACzBF,EAASG,wBACTH,EAASI,UAAU,4BAA4B,SAAAC,GAAY,IAAD,EAChCA,EAAQC,MAAM,KADkB,mBACjDzJ,EADiD,KAC1CC,EAD0C,KAExD,EAAK4D,SAAS,CACZsE,WAAYrI,EACV,CACEE,MAAOL,KAAK+J,IAAI/I,OAAOyH,WAAYuB,OAAO3J,IAC1CC,OAAQ0J,OAAO1J,IAEjBqH,KAGJ6B,EAASS,kB,6CAIXb,SAASc,oBAAoB,aAAcvH,KAAKmG,kBAChDqB,cAAcxH,KAAKkF,Y,sCPlEhB,IAA2BuC,EOqEL,WAArBzH,KAAKP,MAAMwD,OACfjD,KAAKuB,SAAS,CACZqE,SAAUvI,KAAKE,OPvEakK,EOuEWzH,KAAKP,MAAMiG,UPtE/CrI,KAAKE,OAAM,IAAIoI,MAAO+B,UAAYD,EAAKC,iB,oCO0E5C1H,KAAKuB,SAAS,CACZmE,UAAW,IAAIC,KACf1C,MAAO,a,qCAITjD,KAAKuB,SAAS,CACZ0B,MAAO,U,sCAITjD,KAAKuB,SAAS,CACZmE,UAAW,IAAIC,KACf1C,MAAO,SACP2C,SAAU,M,uCAGGnE,GACfA,EAAEkG,iBACFlG,EAAEmG,sB,GA1IYhG,IAAMO,WCLJ0F,QACW,cAA7BxJ,OAAOC,SAASwJ,UAEe,UAA7BzJ,OAAOC,SAASwJ,UAEhBzJ,OAAOC,SAASwJ,SAASC,MACvB,2DCZNC,IAASC,OAAO,kBAAC,EAAD,MAASxB,SAASyB,eAAe,SDmI3C,kBAAmBC,WACrBA,UAAUC,cAAcC,MAAMC,MAAK,SAAAC,GACjCA,EAAaC,iB","file":"static/js/main.27dbe433.chunk.js","sourcesContent":["import { parse } from \"query-string\";\nimport configuration from \"../src/districts/la.json\";\nimport { PuzzleConfiguration, Dimensions } from \"./types\";\n\nfunction parseMilliseconds(milliseconds: number): [number, number] {\n  const minutes = Math.floor(milliseconds / (1000 * 60));\n  const seconds = Math.round((milliseconds - minutes * 60 * 1000) / 1000);\n  return [minutes, seconds];\n}\n\nexport function formatTimeVerbose(milliseconds: number): string {\n  const [minutes, seconds] = parseMilliseconds(milliseconds);\n  const parts = [];\n  if (minutes === 1) {\n    parts.push(\"1 minute\");\n  } else if (minutes > 1) {\n    parts.push(`${minutes || 0} minutes`);\n  }\n  if (seconds === 1) {\n    parts.push(\"1 second\");\n  } else if (seconds > 1) {\n    parts.push(`${seconds || 0} seconds`);\n  }\n  return parts.join(\", \");\n}\n\nexport function formatTime(milliseconds: number): string {\n  const [minutes, seconds] = parseMilliseconds(milliseconds);\n  const minutesStr = minutes >= 10 ? `${minutes}` : `0${minutes}`;\n  const secondsStr = seconds >= 10 ? `${seconds}` : `0${seconds}`;\n  return `${minutesStr}:${secondsStr}`;\n}\n\nexport function getShareUrl(): string {\n  const params = parse(window.location.search);\n  return typeof params.parentUrl === \"string\"\n    ? decodeURIComponent(params.parentUrl)\n    : window.location.href;\n}\n\nexport function getData(): PuzzleConfiguration {\n  return {\n    viewBox: [\n      configuration.viewBox.minX,\n      configuration.viewBox.minY,\n      configuration.viewBox.width,\n      configuration.viewBox.height\n    ],\n    pieces: Object.entries(configuration.paths).map(([key, paths]) => {\n      const [x, y] = configuration.transforms[key] || [\"0\", \"0\"];\n      return {\n        key,\n        paths,\n        transform: [parseFloat(x), parseFloat(y)]\n      };\n    }),\n    title: configuration.title,\n    shareText: configuration.shareText\n  };\n}\n\nexport function millisecondsSince(date: Date): number {\n  return Math.round(new Date().getTime() - date.getTime());\n}\n\nexport function constrainToAspectRatio(\n  { width, height }: Dimensions,\n  aspectRatio: number\n): Dimensions {\n  const ratio = width / height;\n\n  if (ratio > aspectRatio) {\n    // too wide\n    return {\n      height,\n      width: height * aspectRatio\n    };\n  } else if (ratio < aspectRatio) {\n    return {\n      height: width / aspectRatio,\n      width\n    };\n  } else {\n    return { width, height };\n  }\n}\n","import React from \"react\";\nimport { getShareUrl } from \"./utils\";\nimport {\n  FacebookShareButton,\n  TwitterShareButton,\n  EmailShareButton\n} from \"react-share\";\n\nimport { FaRedo, FaFacebookF, FaTwitter, FaRegEnvelope } from \"react-icons/fa\";\n\nexport const EndSlide: React.FunctionComponent<{\n  title: string;\n  subtitle: string;\n  shareText: string;\n  onRestart: () => any;\n}> = ({ title, subtitle, shareText, onRestart }) => {\n  const shareUrl = getShareUrl();\n  return (\n    <div className=\"slide\">\n      <div>\n        <h2>{title}</h2>\n        <p className=\"subtitle\">{subtitle}</p>\n        <div className=\"share-btns\">\n          <FacebookShareButton\n            className=\"puzzle-btn\"\n            url={shareUrl}\n            quote={shareText}\n          >\n            <FaFacebookF color=\"rgb(59, 89, 152)\" />\n            <span>Share</span>\n          </FacebookShareButton>\n          <TwitterShareButton\n            className=\"puzzle-btn\"\n            url={shareUrl}\n            title={shareText}\n          >\n            <FaTwitter color=\"rgb(64, 153, 255)\" />\n            Tweet\n          </TwitterShareButton>\n          <EmailShareButton\n            className=\"puzzle-btn\"\n            url={shareUrl}\n            subject={shareText}\n          >\n            <FaRegEnvelope color=\"rgb(106, 4, 50)\" />\n            Email\n          </EmailShareButton>\n        </div>\n        <div className=\"puzzle-btn\" onClick={onRestart}>\n          <FaRedo />\n          <span>Restart</span>\n        </div>\n      </div>\n    </div>\n  );\n};\n","import React from \"react\";\nimport Draggable, { DraggableData } from \"react-draggable\";\nimport classnames from \"classnames\";\n\nexport class PuzzlePiece extends React.PureComponent<\n  {\n    paths: string[];\n    onDragStart: (index: number) => any;\n    onDragStop: (index: number, DraggableData) => any;\n    color: string;\n    locked: boolean;\n    dragScale: number;\n    position: [number, number];\n    index: number;\n  },\n  {\n    color: string;\n    dragging: boolean;\n    hovering: boolean;\n  }\n> {\n  hoverColor: string;\n  dragColor: string;\n  constructor(props) {\n    super(props);\n    this.state = {\n      color: this.props.color,\n      dragging: false,\n      hovering: false\n    };\n    this.hoverColor = \"rgb(100%, 100%, 44.1%)\";\n    this.dragColor = \"yellow\";\n    this.handleMouseEnter = this.handleMouseEnter.bind(this);\n    this.handleMouseOut = this.handleMouseOut.bind(this);\n  }\n  render() {\n    const pathEls = this.props.paths.map((path, index) => {\n      return (\n        <path\n          d={path}\n          className=\"puzzle-piece-path\"\n          fill={this.state.color}\n          key={index}\n          cursor={this.props.locked ? \"normal\" : \"move\"}\n        />\n      );\n    });\n    return (\n      <Draggable\n        scale={this.props.dragScale}\n        onStart={this.handleDragStart.bind(this)}\n        onStop={this.handleDragStop.bind(this)}\n        disabled={this.props.locked}\n        position={{ x: this.props.position[0], y: this.props.position[1] }}\n      >\n        <g\n          className={classnames({\n            \"puzzle-piece-group\": true,\n            dragging: this.state.dragging,\n            hovering: this.state.hovering\n          })}\n          onMouseEnter={this.handleMouseEnter}\n          onMouseOut={this.handleMouseOut}\n        >\n          {pathEls}\n        </g>\n      </Draggable>\n    );\n  }\n  handleMouseEnter() {\n    this.setState({\n      hovering: true\n    });\n  }\n  handleMouseOut() {\n    this.setState({\n      hovering: false\n    });\n  }\n  handleDragStart() {\n    this.setState({\n      dragging: true\n    });\n    this.props.onDragStart(this.props.index);\n  }\n  handleDragStop(e: MouseEvent, draggableData: DraggableData) {\n    this.setState({\n      dragging: false\n    });\n    this.props.onDragStop(this.props.index, draggableData);\n  }\n}\n","import React, { Ref } from \"react\";\nexport class PuzzleGuide extends React.Component<{\n  paths: string[];\n}> {\n  public ref: Ref<SVGGElement>;\n  constructor(props) {\n    super(props);\n    this.ref = React.createRef();\n  }\n  render() {\n    const pathEls = this.props.paths.map((path, index) => {\n      return <path className=\"puzzle-guide-path\" d={path} key={index} />;\n    });\n    return <g ref={this.ref}>{pathEls}</g>;\n  }\n  getBbox(): ClientRect | null {\n    const ref = this.ref;\n    if (typeof ref === \"object\" && ref && ref.current) {\n      return ref.current.getBoundingClientRect();\n    }\n  }\n}\n","import React, { Ref } from \"react\";\nimport chroma from \"chroma-js\";\nimport { PuzzlePiece } from \"./PuzzlePiece\";\nimport { PuzzleGuide } from \"./PuzzleGuide\";\nimport { Piece } from \"./types\";\nimport { DraggableData } from \"react-draggable\";\n\nexport class Puzzle extends React.PureComponent<\n  {\n    pieces: Piece[];\n    stage: \"initial\" | \"editing\" | \"end\";\n    viewBox: [number, number, number, number];\n    devMode?: boolean;\n    width: number;\n    height: number;\n    onSolved?: () => any;\n  },\n  {\n    pieces: {\n      key: string;\n      paths: string[];\n      color: string;\n      guideRef: Ref<PuzzleGuide>;\n      pieceRef: Ref<PuzzlePiece>;\n      position: [number, number];\n      originalPosition: [number, number];\n    }[];\n    tolerance: number;\n  }\n> {\n  private ref: Ref<SVGSVGElement>;\n  constructor(props) {\n    super(props);\n    const colorScale = chroma\n      .scale(\"Spectral\")\n      .domain([0, props.pieces.length], props.pieces.length);\n\n    this.state = {\n      pieces: props.pieces.map((piece, index) => ({\n        key: piece.key,\n        paths: piece.paths,\n        originalPosition: piece.transform,\n        position: piece.transform,\n        color: colorScale(index),\n        guideRef: React.createRef(),\n        pieceRef: React.createRef()\n      })),\n      tolerance: 30\n    };\n    this.ref = React.createRef();\n    this.handleDragStart = this.handleDragStart.bind(this);\n    this.handleDragStop = this.handleDragStop.bind(this);\n  }\n  render() {\n    const dragScale = this.getDragScale(this.props.width, this.props.height);\n    const pieces = this.state.pieces.map((piece, index) => (\n      <PuzzlePiece\n        index={index}\n        paths={piece.paths}\n        key={piece.key}\n        color={piece.color}\n        onDragStart={this.handleDragStart}\n        onDragStop={this.handleDragStop}\n        dragScale={dragScale}\n        ref={piece.pieceRef}\n        locked={this.props.stage === \"end\"}\n        position={piece.position}\n      />\n    ));\n    const guides = this.state.pieces.map((piece, index) => (\n      <PuzzleGuide paths={piece.paths} ref={piece.guideRef} key={index} />\n    ));\n    const bboxGuide = this.props.devMode ? (\n      <rect\n        x={this.props.viewBox[0]}\n        y={this.props.viewBox[1]}\n        width={this.props.viewBox[2]}\n        height={this.props.viewBox[3]}\n      ></rect>\n    ) : null;\n    return (\n      <div className=\"Puzzle\">\n        <svg\n          width={this.props.width}\n          height={this.props.height}\n          viewBox={this.props.viewBox.join(\" \")}\n          ref={this.ref}\n        >\n          {bboxGuide}\n          {guides}\n          {pieces}\n        </svg>\n      </div>\n    );\n  }\n  componentDidUpdate(prevProps) {\n    if (prevProps.stage !== this.props.stage) {\n      switch (this.props.stage) {\n        case \"editing\":\n        case \"initial\":\n          this.setState({\n            pieces: this.state.pieces.map(piece => {\n              piece.position = piece.originalPosition;\n              return piece;\n            })\n          });\n          break;\n        case \"end\":\n          this.setState({\n            pieces: this.state.pieces.map(piece => {\n              piece.position = [0, 0];\n              return piece;\n            })\n          });\n          break;\n      }\n    }\n  }\n  getDragScale(width: number, height: number): number {\n    if (typeof this.ref !== \"object\") return;\n    const { viewBox } = this.props;\n    const viewPortAspectRatio = width / height;\n    const viewBoxAspectRatio = viewBox[2] / viewBox[3];\n    const heightLimited = viewPortAspectRatio > viewBoxAspectRatio;\n    const pixelsPerCoord = heightLimited\n      ? height / this.props.viewBox[3]\n      : width / this.props.viewBox[2];\n    return pixelsPerCoord;\n  }\n  movePieceToFront(index: number) {\n    if (index === this.state.pieces.length - 1) return;\n    this.setState({\n      pieces: [\n        ...this.state.pieces.slice(0, index),\n        ...this.state.pieces.slice(index + 1, this.state.pieces.length),\n        this.state.pieces[index]\n      ]\n    });\n  }\n  isPieceSolved(index: number): boolean {\n    const {\n      position: [x, y]\n    } = this.state.pieces[index];\n    const { tolerance } = this.state;\n    return x > -tolerance && x < tolerance && y > -tolerance && y < tolerance;\n  }\n  isAllSolved() {\n    this.state.pieces.forEach((piece, index) => this.isPieceSolved(index));\n    return this.state.pieces.every((piece, index) => this.isPieceSolved(index));\n  }\n  handleDragStart(index: number) {\n    this.movePieceToFront(index);\n  }\n  handleDragStop(index: number, e: DraggableData) {\n    const piece = this.state.pieces[index];\n    piece.position = [e.x, e.y];\n\n    this.setState({\n      pieces: [...this.state.pieces]\n    });\n\n    if (this.isAllSolved()) {\n      this.props.onSolved();\n    }\n    this.logPositions();\n  }\n  // for development\n  logPositions() {\n    if (!this.props.devMode) return;\n    const positions = this.state.pieces.reduce((prev, curr) => {\n      const position = curr.position;\n      if (position) {\n        const [x, y] = position;\n        prev[curr.key] = [x.toFixed(1), y.toFixed(1)];\n      }\n      return prev;\n    }, {});\n    console.log(JSON.stringify(positions));\n  }\n}\n","import React from \"react\";\n\nexport const StartSlide: React.FunctionComponent<{\n  title: string;\n  onStart: () => any;\n}> = props => {\n  return (\n    <div className=\"slide\">\n      <div>\n        <h2>{props.title}</h2>\n        <div className=\"puzzle-btn btn-start\" onClick={props.onStart}>\n          Start!\n        </div>\n      </div>\n    </div>\n  );\n};\n","import React from \"react\";\nimport { formatTime } from \"./utils\";\n\nexport const Timer: React.FunctionComponent<{ time: number }> = ({ time }) => {\n  return <div className=\"timer\">{formatTime(time)}</div>;\n};\n","import React from \"react\";\nimport \"./App.css\";\nimport { EndSlide } from \"./EndSlide\";\nimport { Puzzle } from \"./Puzzle\";\nimport { StartSlide } from \"./StartSlide\";\nimport { Timer } from \"./Timer\";\nimport { Piece, Dimensions } from \"./types\";\nimport {\n  formatTimeVerbose,\n  getData,\n  millisecondsSince,\n  constrainToAspectRatio\n} from \"./utils\";\nimport pym from \"pym.js\";\n\nconst ASPECT_RATIO = 0.5;\n\nclass App extends React.Component<\n  {},\n  {\n    stage: \"start\" | \"puzzle\" | \"end\";\n    startTime: Date;\n    pieces: Piece[];\n    duration: number;\n    viewBox: [number, number, number, number];\n    title: string;\n    shareText: string;\n    dimensions: Dimensions;\n  }\n> {\n  public interval: NodeJS.Timeout;\n  constructor(props) {\n    super(props);\n    const { pieces, viewBox, title, shareText } = getData();\n    this.state = {\n      pieces,\n      viewBox,\n      title,\n      shareText,\n      startTime: new Date(),\n      duration: 0,\n      stage: \"start\",\n      dimensions: constrainToAspectRatio(\n        {\n          width: window.innerWidth,\n          height: window.innerHeight\n        },\n        ASPECT_RATIO\n      )\n    };\n    this.handleSolved = this.handleSolved.bind(this);\n    this.handleStart = this.handleStart.bind(this);\n    this.handleRestart = this.handleRestart.bind(this);\n    this.handleTouchStart = this.handleTouchStart.bind(this);\n  }\n  render() {\n    switch (this.state.stage) {\n      case \"start\":\n        return (\n          <div className=\"App\">\n            <StartSlide title={this.state.title} onStart={this.handleStart} />\n            <Puzzle\n              stage=\"initial\"\n              pieces={this.state.pieces}\n              viewBox={this.state.viewBox}\n              width={this.state.dimensions.width}\n              height={this.state.dimensions.height}\n            />\n          </div>\n        );\n      case \"puzzle\":\n        return (\n          <div className=\"App\">\n            <Timer time={this.state.duration} />\n            <Puzzle\n              stage=\"editing\"\n              onSolved={this.handleSolved}\n              pieces={this.state.pieces}\n              viewBox={this.state.viewBox}\n              width={this.state.dimensions.width}\n              height={this.state.dimensions.height}\n            />\n          </div>\n        );\n      case \"end\":\n        const timeVerbose = formatTimeVerbose(this.state.duration);\n        const shareText = this.state.shareText.replace(\"{time}\", timeVerbose);\n        return (\n          <div className=\"App\">\n            <EndSlide\n              title=\"Solved!\"\n              subtitle={`You solved the puzzle in ${timeVerbose}!`}\n              shareText={shareText}\n              onRestart={this.handleRestart}\n            />\n            <Puzzle\n              stage=\"end\"\n              pieces={this.state.pieces}\n              viewBox={this.state.viewBox}\n              width={this.state.dimensions.width}\n              height={this.state.dimensions.height}\n            />\n          </div>\n        );\n    }\n  }\n  componentDidMount() {\n    document.addEventListener(\"touchstart\", this.handleTouchStart);\n    this.interval = setInterval(() => this.incrementTime(), 1000);\n    const pymChild = new pym.Child();\n    pymChild.getParentPositionInfo();\n    pymChild.onMessage(\"viewport-iframe-position\", message => {\n      const [width, height] = message.split(\" \");\n      this.setState({\n        dimensions: constrainToAspectRatio(\n          {\n            width: Math.min(window.innerWidth, Number(width)),\n            height: Number(height)\n          },\n          ASPECT_RATIO\n        )\n      });\n      pymChild.sendHeight();\n    });\n  }\n  componentWillUnmount() {\n    document.removeEventListener(\"touchstart\", this.handleTouchStart);\n    clearInterval(this.interval);\n  }\n  incrementTime() {\n    if (this.state.stage !== \"puzzle\") return;\n    this.setState({\n      duration: Math.round(millisecondsSince(this.state.startTime))\n    });\n  }\n  handleStart() {\n    this.setState({\n      startTime: new Date(),\n      stage: \"puzzle\"\n    });\n  }\n  handleSolved() {\n    this.setState({\n      stage: \"end\"\n    });\n  }\n  handleRestart() {\n    this.setState({\n      startTime: new Date(),\n      stage: \"puzzle\",\n      duration: 0\n    });\n  }\n  handleTouchStart(e: TouchEvent) {\n    e.preventDefault();\n    e.stopPropagation();\n  }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport * as serviceWorker from \"./serviceWorker\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}